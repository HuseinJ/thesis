<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="551px" preserveAspectRatio="none" style="width:1778px;height:551px;background:#FFFFFF;" version="1.1" viewBox="0 0 1778 551" width="1778px" zoomAndPan="magnify"><defs/><g><!--cluster FTAPI Federation Architecture--><g class="cluster" data-entity="FTAPI Federation Architecture" data-source-line="4" data-uid="ent0002" id="cluster_FTAPI Federation Architecture"><path d="M8.5,6 L249.0176,6 A3.75,3.75 0 0 1 251.5176,8.5 L258.5176,28.2969 L1768.5,28.2969 A2.5,2.5 0 0 1 1771,30.7969 L1771,541.69 A2.5,2.5 0 0 1 1768.5,544.19 L8.5,544.19 A2.5,2.5 0 0 1 6,541.69 L6,8.5 A2.5,2.5 0 0 1 8.5,6" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="258.5176" y1="28.2969" y2="28.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="239.5176" x="10" y="20.9951">FTAPI Federation Architecture</text></g><!--cluster SecuMails Bounded Context--><g class="cluster" data-entity="SecuMails Bounded Context" data-source-line="6" data-uid="ent0003" id="cluster_SecuMails Bounded Context"><path d="M32.5,49 L253.9316,49 A3.75,3.75 0 0 1 256.4316,51.5 L263.4316,71.2969 L373.5,71.2969 A2.5,2.5 0 0 1 376,73.7969 L376,268.1 A2.5,2.5 0 0 1 373.5,270.6 L32.5,270.6 A2.5,2.5 0 0 1 30,268.1 L30,51.5 A2.5,2.5 0 0 1 32.5,49" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="30" x2="263.4316" y1="71.2969" y2="71.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="220.4316" x="34" y="63.9951">SecuMails Bounded Context</text></g><!--cluster Federation Bounded Context--><g class="cluster" data-entity="Federation Bounded Context" data-source-line="12" data-uid="ent0007" id="cluster_Federation Bounded Context"><path d="M402.5,183.3 L630.7813,183.3 A3.75,3.75 0 0 1 633.2813,185.8 L640.2813,205.5969 L1162.5,205.5969 A2.5,2.5 0 0 1 1165,208.0969 L1165,517.69 A2.5,2.5 0 0 1 1162.5,520.19 L402.5,520.19 A2.5,2.5 0 0 1 400,517.69 L400,185.8 A2.5,2.5 0 0 1 402.5,183.3" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="400" x2="640.2813" y1="205.5969" y2="205.5969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="227.2813" x="404" y="198.2951">Federation Bounded Context</text></g><!--cluster Platform Layer--><g class="cluster" data-entity="Platform Layer" data-source-line="20" data-uid="ent0013" id="cluster_Platform Layer"><path d="M1191.5,432.89 L1309.668,432.89 A3.75,3.75 0 0 1 1312.168,435.39 L1319.168,455.1869 L1700.5,455.1869 A2.5,2.5 0 0 1 1703,457.6869 L1703,517.69 A2.5,2.5 0 0 1 1700.5,520.19 L1191.5,520.19 A2.5,2.5 0 0 1 1189,517.69 L1189,435.39 A2.5,2.5 0 0 1 1191.5,432.89" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1189" x2="1319.168" y1="455.1869" y2="455.1869"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="117.168" x="1193" y="447.8851">Platform Layer</text></g><!--entity MailDeliveryService--><g class="entity" data-entity="MailDeliveryService" data-source-line="7" data-uid="ent0004" id="entity_MailDeliveryService"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="158.291" x="174.85" y="84"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138.291" x="184.85" y="106.9951">MailDeliveryService</text></g><!--entity Mailbox--><g class="entity" data-entity="Mailbox" data-source-line="8" data-uid="ent0005" id="entity_Mailbox"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74.1748" x="189.91" y="218.3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.1748" x="199.91" y="241.2951">Mailbox</text></g><!--entity User--><g class="entity" data-entity="User" data-source-line="9" data-uid="ent0006" id="entity_User"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.9102" x="55.04" y="84"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="65.04" y="106.9951">User</text></g><!--entity FederationService--><g class="entity" data-entity="FederationService" data-source-line="13" data-uid="ent0008" id="entity_FederationService"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147.0596" x="764.47" y="218.3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.0596" x="774.47" y="241.2951">FederationService</text></g><!--entity FederatedUser--><g class="entity" data-entity="FederatedUser" data-source-line="14" data-uid="ent0009" id="entity_FederatedUser"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123.4004" x="484.3" y="467.89"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103.4004" x="494.3" y="490.8851">FederatedUser</text></g><!--entity FederationSession--><g class="entity" data-entity="FederationSession" data-source-line="15" data-uid="ent0010" id="entity_FederationSession"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148.7344" x="1000.63" y="333.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128.7344" x="1010.63" y="356.5951">FederationSession</text></g><!--entity TrustRegistry--><g class="entity" data-entity="TrustRegistry" data-source-line="16" data-uid="ent0011" id="entity_TrustRegistry"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.9053" x="852.05" y="333.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.9053" x="862.05" y="356.5951">TrustRegistry</text></g><!--entity KeyExchangeService--><g class="entity" data-entity="KeyExchangeService" data-source-line="17" data-uid="ent0012" id="entity_KeyExchangeService"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="166.4736" x="650.76" y="333.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146.4736" x="660.76" y="356.5951">KeyExchangeService</text></g><!--entity CertificateStore--><g class="entity" data-entity="CertificateStore" data-source-line="21" data-uid="ent0014" id="entity_CertificateStore"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130.0313" x="1204.98" y="467.89"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.0313" x="1214.98" y="490.8851">CertificateStore</text></g><!--entity LoggingService--><g class="entity" data-entity="LoggingService" data-source-line="22" data-uid="ent0015" id="entity_LoggingService"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.5293" x="1370.24" y="467.89"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.5293" x="1380.24" y="490.8851">LoggingService</text></g><!--entity Monitoring/Alerting--><g class="entity" data-entity="Monitoring/Alerting" data-source-line="23" data-uid="ent0016" id="entity_Monitoring/Alerting"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="154.5586" x="1532.72" y="467.89"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134.5586" x="1542.72" y="490.8851">Monitoring/Alerting</text></g><!--link MailDeliveryService to FederationService--><g class="link" data-entity-1="MailDeliveryService" data-entity-2="FederationService" data-source-line="26" data-uid="lnk17" id="link_MailDeliveryService_FederationService"><path d="M331.85,120.79 C445.05,146.43 647.7483,192.344 758.5183,217.444" fill="none" id="MailDeliveryService-to-FederationService" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="764.37,218.77,756.4765,212.88,759.4936,217.665,754.7085,220.6822,764.37,218.77" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.0625" x="529.49" y="163.3669">For external recipients</text></g><!--link FederationService to FederatedUser--><g class="link" data-entity-1="FederationService" data-entity-2="FederatedUser" data-source-line="27" data-uid="lnk18" id="link_FederationService_FederatedUser"><path d="M764.31,245.99 C667.05,258.96 503.93,287.13 468,333.6 C434.17,377.35 486.8895,434.0106 520.1895,463.5206" fill="none" id="FederationService-to-FederatedUser" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="524.68,467.5,520.5972,458.5373,520.9379,464.1838,515.2914,464.5246,524.68,467.5" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.249" x="469" y="356.3069">Resolve remote user info</text></g><!--link FederationService to FederationSession--><g class="link" data-entity-1="FederationService" data-entity-2="FederationSession" data-source-line="28" data-uid="lnk19" id="link_FederationService_FederationSession"><path d="M874.77,255.03 C919.24,276.28 988.2271,309.2615 1032.7271,330.5415" fill="none" id="FederationService-to-FederationSession" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1038.14,333.13,1031.7463,325.6387,1033.6292,330.9729,1028.295,332.8559,1038.14,333.13" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.4546" x="971.69" y="299.6669">Manage server connections</text></g><!--link FederationService to KeyExchangeService--><g class="link" data-entity-1="FederationService" data-entity-2="KeyExchangeService" data-source-line="29" data-uid="lnk20" id="link_FederationService_KeyExchangeService"><path d="M764.17,242.31 C733.96,248.37 701.76,260.97 683,286.6 C671.15,302.78 682.9918,317.0515 700.3618,329.7915" fill="none" id="FederationService-to-KeyExchangeService" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="705.2,333.34,700.3084,324.7917,701.1682,330.3829,695.5771,331.2426,705.2,333.34" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.0205" x="684" y="299.6669">Fetch encryption key</text></g><!--link FederationService to TrustRegistry--><g class="link" data-entity-1="FederationService" data-entity-2="TrustRegistry" data-source-line="30" data-uid="lnk21" id="link_FederationService_TrustRegistry"><path d="M832.48,254.87 C829.1,268.9 826.82,288.68 835,303.6 C841.96,316.28 848.7808,323.0038 861.1008,330.2638" fill="none" id="FederationService-to-TrustRegistry" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="866.27,333.31,860.5469,325.2946,861.9623,330.7715,856.4854,332.1869,866.27,333.31" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.0801" x="836" y="299.6669">Validate trust</text></g><!--link FederationService to CertificateStore--><g class="link" data-entity-1="FederationService" data-entity-2="CertificateStore" data-source-line="31" data-uid="lnk22" id="link_FederationService_CertificateStore"><path d="M911.8,241.23 C994.15,246.74 1120.95,259.42 1160,286.6 C1224.82,331.72 1254.0703,422.083 1264.3603,461.663" fill="none" id="FederationService-to-CertificateStore" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1265.87,467.47,1267.4768,457.7531,1264.6119,462.6309,1259.7342,459.766,1265.87,467.47" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.4307" x="1229.49" y="356.3069">Mutual TLS certs</text></g><!--link FederationService to LoggingService--><g class="link" data-entity-1="FederationService" data-entity-2="LoggingService" data-source-line="32" data-uid="lnk23" id="link_FederationService_LoggingService"><path d="M911.87,243.22 C1035.94,254.24 1279.18,281.89 1346,333.6 C1391.93,369.14 1416.4294,430.2523 1426.8694,461.8823" fill="none" id="FederationService-to-LoggingService" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1428.75,467.58,1429.7275,457.7798,1427.1828,462.832,1422.1307,460.2872,1428.75,467.58" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.4214" x="1381.38" y="356.3069">Audit federation event</text></g><!--link FederationService to Monitoring/Alerting--><g class="link" data-entity-1="FederationService" data-entity-2="Monitoring/Alerting" data-source-line="33" data-uid="lnk24" id="link_FederationService_Monitoring/Alerting"><path d="M911.91,238.78 C1070.83,243.02 1438.55,260.67 1536,333.6 C1580.87,367.17 1598.7795,429.3896 1605.5795,461.5696" fill="none" id="FederationService-to-Monitoring/Alerting" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1606.82,467.44,1608.8729,457.8075,1605.7863,462.548,1601.0457,459.4614,1606.82,467.44" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.6396" x="1569.14" y="356.3069">Track success/failure</text></g><!--link FederationSession to CertificateStore--><g class="link" data-entity-1="FederationSession" data-entity-2="CertificateStore" data-source-line="35" data-uid="lnk25" id="link_FederationSession_CertificateStore"><path d="M1087.32,370.25 C1098.45,384.79 1116.09,404.96 1136,416.89 C1147.47,423.77 1152.66,419.75 1165,424.89 C1193.12,436.61 1218.0095,451.1264 1238.6995,464.3064" fill="none" id="FederationSession-to-CertificateStore" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1243.76,467.53,1238.3184,459.3209,1239.543,464.8436,1234.0202,466.0682,1243.76,467.53" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.4521" x="1137" y="412.9569">Fetch certs</text></g><!--link KeyExchangeService to FederatedUser--><g class="link" data-entity-1="KeyExchangeService" data-entity-2="FederatedUser" data-source-line="36" data-uid="lnk26" id="link_KeyExchangeService_FederatedUser"><path d="M709.04,370.31 C673.08,395.62 611.9869,438.6071 575.9769,463.9471" fill="none" id="KeyExchangeService-to-FederatedUser" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="571.07,467.4,580.7322,465.4919,575.1591,464.5226,576.1283,458.9494,571.07,467.4" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.2441" x="663.37" y="412.9569">Store public key</text></g><!--link MailDeliveryService to Mailbox--><g class="link" data-entity-1="MailDeliveryService" data-entity-2="Mailbox" data-source-line="38" data-uid="lnk27" id="link_MailDeliveryService_Mailbox"><path d="M250.41,120.72 C245.25,146.02 236.969,186.581 231.799,211.931" fill="none" id="MailDeliveryService-to-Mailbox" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="230.6,217.81,236.3178,209.7909,231.5992,212.9108,228.4792,208.1922,230.6,217.81" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.3521" x="244.71" y="163.3669">For internal delivery</text></g><!--link FederationService to Mailbox--><g class="link" data-entity-1="FederationService" data-entity-2="Mailbox" data-source-line="39" data-uid="lnk28" id="link_FederationService_Mailbox"><path d="M764.19,236.45 C632.85,236.45 369.08,236.45 270.3,236.45" fill="none" id="FederationService-to-Mailbox" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="264.3,236.45,273.3,240.45,269.3,236.45,273.3,232.45,264.3,236.45" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.1221" x="400.28" y="229.5169">Inject message on receiving server</text></g><!--link User to Mailbox--><g class="link" data-entity-1="User" data-entity-2="Mailbox" data-source-line="41" data-uid="lnk29" id="link_User_Mailbox"><path d="M91.25,120.76 C99.74,134.42 112.68,153.32 127,167.3 C147.59,187.41 169.6448,202.4234 190.4648,214.9134" fill="none" id="User-to-Mailbox" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="195.61,218,189.95,209.94,191.3224,215.4278,185.8345,216.8002,195.61,218" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.9141" x="128" y="163.3669">Message access</text></g><!--SRC=[ZLHDRzim3BtxLn2zz1JqliE0j5c0O0bGrDakmmwgJ3jSPCdGXn5Zw7yVvIWVJXrZljYco4U-nsS_mcAnW2KMQ8Kdes5kvOuyIXyimWoMs_dh2bRQevL6QuvJIxxBt9vq8woeGPgwCHgrptsd42od25qfpB96oBse41wE87UQFC3VB0Cu9-SemqQGSl1iWYwmW1V3xGy-9W9Vl-Bf0XMrQBiSRKiIVrzEtiqXlVrmQEFZnm3_Qenx3IufG_WKn-A4V9Fh7DzIV6k3yszOaVEsIx7ls7qxo1tBWrV0m_5UbV2biJMiHOVsFD8BMaybIUwUUsDF4wrDLP6kRbGmcZY7uqzp5UjqTUupAXxCPb_7MCCNM1eBB0rQBLJSBJN4gtRPg4e3dAGIOxoXCwgDrgYDHmWS1jAb-G-GAraPQ2Dqr8ZhUNeu-T7eoN56H8-yqCiTe9QsQtelxB6RGXckam5-2aK5imGVJwPAFwqkCWa-iA3RTGwIZoS9tEoOg-UX80_bnSZOybAcCCOimK1RoxO35wHaaPzAjWP_a5asQklxP8vQddcC2JvkZ1u1cl2kIFOBc3RewUjEjYITR5cax4a1BhKh_OTj0pNpYcvY-TZNoByrNILhzNCSXxmjtgGgqKkMVVm3]--></g></svg>